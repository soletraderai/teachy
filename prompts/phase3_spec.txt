<phase_specification>
  <phase_number>3</phase_number>
  <depends_on>phase2 (phase2_spec.txt)</depends_on>

  <phase_goals>
    Transform Teachy into QuizTube through a complete rebrand, modern sidebar navigation, intelligent learning notes derived from transcripts, creator-friendly engagement features, live search with autocomplete, and smart recommendations. This phase focuses on user experience improvements that increase session completion, reduce friction when stuck on questions, and give back to YouTube creators.
  </phase_goals>

  <design_philosophy>
    <principle name="modern_saas_feel">Sidebar navigation like Linear, Notion, Discord - not traditional top navbar</principle>
    <principle name="learning_context">Users should never need to re-watch videos when stuck - notes provide instant context</principle>
    <principle name="creator_reciprocity">Platform gives back to creators whose content enables learning</principle>
    <principle name="instant_feedback">Live search, real-time filtering - no page reloads or waiting</principle>
    <principle name="context_awareness">UI adapts to content type - code editor only for programming</principle>
  </design_philosophy>

  <feature_count>285</feature_count>

  <success_metrics>
    <metric name="time_to_answer_with_notes">-40% reduction vs without notes</metric>
    <metric name="search_to_session_conversion">80%+ (currently ~60%)</metric>
    <metric name="creator_engagement_rate">30% of sessions</metric>
    <metric name="session_completion_rate">85%+ (currently ~70%)</metric>
    <metric name="user_satisfaction_nps">+15 points improvement</metric>
    <metric name="help_panel_usage">40%+ of stuck users</metric>
    <metric name="search_response_time">less than 500ms p95</metric>
    <metric name="animation_frame_rate">60fps for sidebar and panels</metric>
  </success_metrics>

  <new_features>
    <theme_a_rebrand>
      <description>Complete rebrand from Teachy to QuizTube with updated visual identity</description>
      <priority>P0 - Launch Required</priority>
      <tier>All users</tier>

      <A1_quiztube_rebrand>
        <requirements>
          - Replace "Teachy" with "QuizTube" in all UI text (headers, buttons, labels)
          - Update page titles to "QuizTube - [Page Name]"
          - Update HTML meta tags (title, description, keywords)
          - Update logo in header/sidebar to QuizTube logo
          - Update favicon to QuizTube icon
          - Update all email templates with QuizTube branding
          - Update Terms of Service references to QuizTube
          - Update Privacy Policy references to QuizTube
          - Update Open Graph metadata for social sharing
          - Update Twitter Card metadata
          - Update Stripe product names to "QuizTube Pro"
          - Update Stripe product descriptions
          - Update Stripe checkout page branding
          - Update error pages with QuizTube branding
          - Update loading screens with QuizTube branding
          - Update 404 page with QuizTube branding
          - Update onboarding screens with QuizTube branding
          - Zero instances of "Teachy" in user-facing UI
        </requirements>
      </A1_quiztube_rebrand>

      <A2_material_icons>
        <requirements>
          - Install Google Material Icons library
          - Replace all existing icons with Material Icons
          - Home/Dashboard icon: "home" or "dashboard"
          - Library icon: "video_library"
          - Progress icon: "trending_up" or "insights"
          - Settings icon: "settings"
          - Profile icon: "account_circle"
          - Search icon: "search"
          - Notifications icon: "notifications"
          - Help/Support icon: "help_outline"
          - Logout icon: "logout"
          - Collapse sidebar icon: "chevron_left"
          - Expand sidebar icon: "chevron_right"
          - Navigation icon size: 24px
          - Inline icon size: 20px
          - Icons visible in both light and dark contexts
          - Icons maintain neobrutalism aesthetic (bold, clear)
          - Icons render correctly at all sizes
          - Icons have appropriate ARIA labels
        </requirements>
      </A2_material_icons>
    </theme_a_rebrand>

    <theme_b_navigation>
      <description>Modern sidebar navigation replacing top navbar</description>
      <priority>P0 - Launch Required</priority>
      <tier>All users</tier>

      <B1_sidebar_navigation>
        <requirements>
          - Replace top navbar with left sidebar
          - Dark background for sidebar (#1a1a1a or similar)
          - Sidebar width: 240px when expanded
          - Sidebar width: 64px when collapsed
          - Smooth collapse/expand animation (300ms ease-in-out)
          - Persist collapse state in localStorage
          - Load collapse state on app initialization
          - Hamburger/chevron toggle button visible
          - Toggle button changes icon based on state
          - Nav items show icon + text when expanded
          - Nav items show icon only when collapsed
          - Hover tooltips in collapsed state (200ms delay)
          - Active nav item has bold left border accent (#FFDE59)
          - Nav item hover: subtle background highlight
          - Nav item hover: slight scale (1.02)
          - QuizTube logo at top of sidebar
          - Logo collapses to "QT" abbreviation when collapsed
          - Divider line separating main nav from footer nav
          - Sidebar renders on all authenticated pages
          - No layout shift when toggling sidebar
          - Main content area adjusts width smoothly
          - Sidebar z-index above main content
          - Keyboard shortcut to toggle (Cmd/Ctrl + B)
        </requirements>
      </B1_sidebar_navigation>

      <B2_responsive_sidebar>
        <requirements>
          - Desktop (1024px+): Sidebar always visible, collapsible
          - Desktop: Default to user's saved preference
          - Tablet (768-1023px): Sidebar starts collapsed
          - Tablet: Can expand on demand
          - Mobile (less than 768px): Sidebar as overlay/drawer
          - Mobile: Hamburger menu icon in header
          - Mobile: Tap hamburger to toggle drawer
          - Mobile: Drawer slides in from left
          - Mobile: Drawer has semi-transparent backdrop
          - Mobile: Tap outside drawer to close
          - Mobile: Drawer close animation (300ms)
          - Smooth transition between breakpoints
          - No horizontal scroll on any device
          - Touch-friendly tap targets (min 44x44px)
          - Swipe gesture to close drawer on mobile
        </requirements>
      </B2_responsive_sidebar>

      <B3_avatar_profile>
        <requirements>
          - Hide Login/Register links when user is authenticated
          - Show user avatar in sidebar bottom section
          - Avatar displays user's profile image if available
          - Avatar shows user's first initial if no image
          - Initial displayed in colored circle
          - Avatar clicks navigate to profile page
          - Avatar visible in both expanded and collapsed states
          - Expanded: Show avatar + user name
          - Collapsed: Show avatar only
          - Dropdown menu on avatar hover/click (P1)
          - Dropdown contains: Profile, Settings, Logout
          - Show subscription tier badge (Free/Pro) near avatar
          - Badge styling: subtle pill shape
          - Graceful fallback for users without profile image
        </requirements>
      </B3_avatar_profile>
    </theme_b_navigation>

    <theme_c_learning>
      <description>Intelligent learning notes and contextual help</description>
      <priority>P0/P1</priority>
      <tier>All users</tier>

      <C1_session_notes>
        <requirements>
          - Extract transcript from YouTube video
          - Process transcript into structured learning notes via AI
          - Break transcript into logical sections/topics
          - Create clear markdown headers for each section
          - Add timestamps in [MM:SS] format to each section
          - Extract key concepts as bullet points
          - Preserve code examples with proper formatting
          - Identify main takeaways per section
          - Keep language concise and scannable
          - Format notes in clean markdown
          - Store generated notes in database with session
          - Store notes generation timestamp
          - Generate notes during session setup (before questions)
          - Notes generation completes within 10 seconds
          - Show loading state during generation
          - Handle generation failures gracefully
          - Retry failed generation up to 3 times
          - Cache notes (don't regenerate for same session)
          - Notes persist with session data
          - Notes accessible from session view
          - Notes accessible from library session detail
        </requirements>
        <note_format>
          ## [Topic Name] [MM:SS]
          - Key point 1
          - Key point 2
          - **Important concept**: explanation

          ### Code Example (if applicable)
          ```language
          code here
          ```
        </note_format>
      </C1_session_notes>

      <C2_help_panel>
        <requirements>
          - "Get Help" button visible during every question
          - Button positioned near answer input
          - Button has clear icon (help_outline)
          - Desktop: Panel slides out from right side
          - Desktop: Panel width 400px
          - Desktop: Panel has dark header with "Session Notes"
          - Desktop: Panel slides with smooth animation (300ms)
          - Desktop: Click outside panel to close
          - Mobile: Panel opens as bottom sheet modal
          - Mobile: Bottom sheet has drag handle
          - Mobile: Swipe down to close
          - Mobile: Tap backdrop to close
          - Panel shows notes section relevant to current question
          - Question-to-notes mapping stored in database
          - Relevant content highlighted or emphasized
          - Timestamp links displayed as clickable
          - Timestamp clicks open YouTube at that position (new tab)
          - YouTube URL includes timestamp parameter (?t=XXs)
          - "Still stuck?" link shows full transcript
          - Track when users access help (analytics)
          - Track which questions trigger help usage
          - Panel remembers scroll position if reopened
          - Panel closes when moving to next question
          - Panel accessible via keyboard shortcut
          - Panel has close button (X icon)
        </requirements>
      </C2_help_panel>

      <C3_context_code_editor>
        <requirements>
          - Analyze session content to detect code relevance
          - Detection: code blocks (```) in transcript
          - Detection: programming keywords (function, const, let, var, class, import, export, def, return)
          - Detection: language mentions (JavaScript, Python, React, Node, CSS, HTML, SQL, TypeScript)
          - Detection: tutorial context ("let's write", "type this code", "run this")
          - Threshold: 3+ indicators = show code editor
          - Show code editor only when code detected
          - Hide code editor for non-programming content
          - Store code relevance flag with session
          - Manual toggle button to show/hide code editor
          - Toggle button visible in session toolbar
          - Remember user preference per session
          - No false positives for cooking/fitness/etc videos
          - Code editor detection accuracy greater than 90%
          - Code editor appears in appropriate position
          - Code editor doesn't interfere with Q&A flow
        </requirements>
      </C3_context_code_editor>
    </theme_c_learning>

    <theme_d_creator>
      <description>Features that give back to YouTube creators</description>
      <priority>P1</priority>
      <tier>All users</tier>

      <D1_creator_engagement>
        <requirements>
          - "Support the Creator" section in session UI
          - Section positioned after question area or in sidebar
          - Section has clear heading with icon
          - Display creator channel name
          - Display creator channel avatar/thumbnail
          - Display subscriber count (if available)
          - Fetch creator info from YouTube API
          - Cache creator info to reduce API calls
          - "Like Video" button with thumbs up icon
          - Like button opens YouTube video page in new tab
          - "Comment" button with comment icon
          - Comment button opens YouTube video comment section
          - Pre-fill comment text if possible, or copy to clipboard
          - "Subscribe" button with bell icon
          - Subscribe button opens channel page in new tab
          - Track like button clicks (analytics)
          - Track comment button clicks (analytics)
          - Track subscribe button clicks (analytics)
          - Store engagement in creator_engagements table
          - Post-session prompt: "Did you find this helpful?"
          - Post-session prompt shows creator name
          - Post-session prompt has "Like on YouTube" button
          - Post-session prompt has "Maybe Later" option
          - Post-session prompt appears for first session with creator
          - Don't show prompt if user already engaged
          - Creator section styling matches neobrutalism design
          - Creator section responsive on mobile
        </requirements>
      </D1_creator_engagement>
    </theme_d_creator>

    <theme_e_search>
      <description>Live search and improved URL validation</description>
      <priority>P0/P1</priority>
      <tier>All users</tier>

      <E1_live_search>
        <requirements>
          - Search input in sidebar or header
          - Search icon (magnifying glass) in input
          - Debounced API calls (300ms delay)
          - Display up to 5 autocomplete suggestions
          - Suggestions appear in dropdown below input
          - Each suggestion shows session title
          - Each suggestion shows video thumbnail (small)
          - Each suggestion shows channel name
          - Keyboard navigation: up/down arrows to select
          - Keyboard navigation: enter to select highlighted
          - Keyboard navigation: escape to close dropdown
          - Mouse click to select suggestion
          - Clicking suggestion navigates to session
          - Live filter library results as user types
          - Library grid updates in real-time
          - Clear button (X) to reset search
          - Clear button visible when input has text
          - Loading indicator during search API call
          - "No results" state with helpful message
          - "No results" suggests trying different terms
          - Recent searches dropdown (last 5)
          - Recent searches appear on input focus
          - Recent searches clickable to re-run
          - Search results appear within 500ms
          - Search handles empty input gracefully
          - Search handles special characters
          - Search is case-insensitive
          - Search matches video titles
          - Search matches topic names
          - Search matches channel names
          - Log search queries for analytics
          - Log which results were selected
        </requirements>
      </E1_live_search>

      <E2_url_validation>
        <requirements>
          - Validate URL format on input
          - Real-time validation as user types
          - Accept: https://www.youtube.com/watch?v=VIDEO_ID
          - Accept: https://youtube.com/watch?v=VIDEO_ID
          - Accept: https://youtu.be/VIDEO_ID
          - Accept: https://www.youtube.com/shorts/VIDEO_ID
          - Accept: https://m.youtube.com/watch?v=VIDEO_ID
          - Accept URLs with additional parameters
          - Reject non-YouTube URLs
          - Reject invalid URL formats
          - Reject empty input
          - Show error state with red border
          - Show error icon in input
          - Show error message below input
          - Error message: "Please enter a valid YouTube URL"
          - Show supported format examples in error
          - Format examples as bulleted list
          - Clear error when user fixes URL
          - Validation runs before API call
          - Prevent form submission with invalid URL
          - Handle URLs with timestamps gracefully
          - Extract video ID from all valid formats
        </requirements>
      </E2_url_validation>
    </theme_e_search>

    <theme_f_recommendations>
      <description>Smart recommendations for personalized learning</description>
      <priority>P1/P2</priority>
      <tier>All users (basic), Pro (advanced)</tier>

      <F1_what_to_learn_next>
        <requirements>
          - Recommendations section on dashboard
          - Section title: "Recommended for You" or similar
          - Analyze completed sessions for recommendations
          - Analyze performance (accuracy) by topic
          - Identify topics with less than 70% accuracy as "Review Needed"
          - "Review Needed" card with topic name and accuracy
          - "Review Needed" card has "Start Review" button
          - Identify next video from same creator/playlist
          - "Continue Series" card with video title
          - "Continue Series" card has "Continue" button
          - Identify related topics to branch into
          - "Expand Knowledge" card with topic suggestion
          - Identify spaced repetition items due
          - "Due for Review" card with count of items
          - "Due for Review" card has "Quick Review" button
          - Show at least 3 recommendation cards
          - Recommendations update after each session
          - Recommendations personalized to user history
          - One-click to start recommended session
          - Cards styled in neobrutalism design
          - Cards have appropriate icons
          - Empty state if no recommendations yet
          - Empty state encourages starting first session
          - Recommendations load quickly (cached)
        </requirements>
      </F1_what_to_learn_next>

      <F2_topic_gap_analysis>
        <requirements>
          - "Knowledge Gaps" section in progress dashboard
          - Identify topics with low performance
          - Show gap topics with accuracy percentage
          - Suggest specific videos to address each gap
          - Track improvement over time
          - Show progress indicators for gap topics
          - Pro-only feature indicator
          - Graceful degradation for free users
        </requirements>
        <priority>P2</priority>
      </F2_topic_gap_analysis>

      <F3_learning_paths>
        <requirements>
          - User can create a learning goal
          - Goal input: "Learn React" or similar topic
          - AI generates ordered list of recommended videos
          - Learning path stored in database
          - Progress tracked through learning path
          - Visual progress indicator (X of Y complete)
          - Adjust path based on performance
          - Skip items in path
          - Reorder items in path
          - Add custom items to path
          - Delete learning path
          - Pro-only feature
        </requirements>
        <priority>P2</priority>
      </F3_learning_paths>
    </theme_f_recommendations>

    <theme_g_technical>
      <description>Code architecture improvements</description>
      <priority>P1</priority>

      <G1_route_management>
        <requirements>
          - Create centralized route configuration file
          - Define all routes in single source of truth
          - Route config structure: auth, app, subscription, legal
          - Type-safe route parameters
          - Helper functions for dynamic routes (getSessionUrl, etc)
          - No hardcoded route strings in components
          - Route guards for authentication
          - Protected routes redirect to login
          - Public routes accessible without auth
          - Lazy loading for route components
          - Breadcrumb generation from route config
          - Route change analytics tracking
          - 404 handling for unknown routes
          - Route history management
        </requirements>
        <route_structure>
          routes = {
            home: '/',
            auth: { login, register, forgotPassword, resetPassword, verifyEmail },
            app: { dashboard, library, session, newSession, progress, settings, profile },
            subscription: { plans, checkout, success },
            legal: { terms, privacy }
          }
        </route_structure>
      </G1_route_management>
    </theme_g_technical>
  </new_features>

  <database_changes>
    <new_tables>
      <session_learning_notes>
        - id: UUID primary key
        - session_id: UUID foreign key sessions (unique)
        - notes_markdown: TEXT (the generated markdown notes)
        - sections: JSONB (array of section metadata)
        - code_detected: BOOLEAN default false
        - code_detection_signals: JSONB (what triggered detection)
        - generated_at: TIMESTAMP
        - generation_duration_ms: INTEGER
        - model_used: VARCHAR(100)
        - created_at: TIMESTAMP
        - updated_at: TIMESTAMP
      </session_learning_notes>

      <question_note_mappings>
        - id: UUID primary key
        - question_id: UUID foreign key questions
        - session_id: UUID foreign key sessions
        - note_section_id: VARCHAR(100) (e.g., "section-2-useState")
        - section_title: VARCHAR(255)
        - start_timestamp_seconds: INTEGER
        - end_timestamp_seconds: INTEGER
        - relevance_score: FLOAT (0.0-1.0)
        - created_at: TIMESTAMP
      </question_note_mappings>

      <creator_engagements>
        - id: UUID primary key
        - user_id: UUID foreign key users
        - session_id: UUID foreign key sessions
        - channel_id: VARCHAR(100)
        - channel_name: VARCHAR(255)
        - video_id: VARCHAR(50)
        - engagement_type: ENUM ('like', 'comment', 'subscribe')
        - clicked_at: TIMESTAMP
        - created_at: TIMESTAMP
        - INDEX on (user_id, channel_id, engagement_type)
      </creator_engagements>

      <search_logs>
        - id: UUID primary key
        - user_id: UUID foreign key users
        - query: VARCHAR(255)
        - results_count: INTEGER
        - selected_result_id: UUID nullable
        - selected_result_position: INTEGER nullable
        - search_duration_ms: INTEGER
        - created_at: TIMESTAMP
        - INDEX on (user_id, created_at)
      </search_logs>

      <recent_searches>
        - id: UUID primary key
        - user_id: UUID foreign key users
        - query: VARCHAR(255)
        - last_used_at: TIMESTAMP
        - use_count: INTEGER default 1
        - created_at: TIMESTAMP
        - UNIQUE constraint on (user_id, query)
      </recent_searches>

      <learning_paths>
        - id: UUID primary key
        - user_id: UUID foreign key users
        - title: VARCHAR(255) (e.g., "Learn React")
        - description: TEXT nullable
        - status: ENUM ('active', 'completed', 'abandoned') default 'active'
        - items_total: INTEGER default 0
        - items_completed: INTEGER default 0
        - created_at: TIMESTAMP
        - updated_at: TIMESTAMP
        - completed_at: TIMESTAMP nullable
      </learning_paths>

      <learning_path_items>
        - id: UUID primary key
        - learning_path_id: UUID foreign key learning_paths
        - video_url: VARCHAR(500)
        - video_id: VARCHAR(50)
        - video_title: VARCHAR(255)
        - video_thumbnail: VARCHAR(500)
        - channel_name: VARCHAR(255)
        - position: INTEGER
        - status: ENUM ('pending', 'completed', 'skipped') default 'pending'
        - session_id: UUID nullable foreign key sessions
        - completed_at: TIMESTAMP nullable
        - created_at: TIMESTAMP
      </learning_path_items>

      <user_sidebar_preferences>
        - id: UUID primary key
        - user_id: UUID foreign key users (unique)
        - sidebar_collapsed: BOOLEAN default false
        - created_at: TIMESTAMP
        - updated_at: TIMESTAMP
      </user_sidebar_preferences>
    </new_tables>

    <modified_tables>
      <sessions>
        - Add column: has_learning_notes BOOLEAN default false
        - Add column: code_content_detected BOOLEAN default false
        - Add column: creator_engagement_prompted BOOLEAN default false
      </sessions>
    </modified_tables>

    <indexes>
      - CREATE INDEX idx_question_note_mappings_question ON question_note_mappings(question_id)
      - CREATE INDEX idx_question_note_mappings_session ON question_note_mappings(session_id)
      - CREATE INDEX idx_creator_engagements_user_session ON creator_engagements(user_id, session_id)
      - CREATE INDEX idx_search_logs_user_date ON search_logs(user_id, created_at DESC)
      - CREATE INDEX idx_learning_path_items_path ON learning_path_items(learning_path_id, position)
    </indexes>
  </database_changes>

  <new_api_endpoints>
    <notes>
      - GET /api/sessions/:id/notes
        Returns learning notes for session, generates if not exists
        Response: { notes_markdown, sections, code_detected, generated_at }

      - POST /api/sessions/:id/notes/generate
        Force regenerate notes for session
        Response: { notes_markdown, sections, generation_duration_ms }

      - GET /api/questions/:id/note-mapping
        Get note section mapped to specific question
        Response: { section_id, section_title, start_timestamp, end_timestamp, content }
    </notes>

    <search>
      - GET /api/search?q=query&limit=5
        Live search with autocomplete
        Response: { results: [{ id, title, thumbnail, channel, type }], total }

      - GET /api/search/recent
        Get user's recent searches (last 5)
        Response: { searches: [{ query, last_used_at, use_count }] }

      - DELETE /api/search/recent
        Clear user's recent searches
    </search>

    <creator>
      - GET /api/sessions/:id/creator
        Get creator info for session's video
        Response: { channel_id, channel_name, channel_thumbnail, subscriber_count }

      - POST /api/engagements
        Track creator engagement click
        Body: { session_id, channel_id, engagement_type }
        Response: { id, created_at }

      - GET /api/users/me/engagements
        Get user's engagement history
        Response: { engagements: [{ channel_name, engagement_type, clicked_at }] }
    </creator>

    <recommendations>
      - GET /api/recommendations
        Get personalized recommendations
        Response: { review_needed: [], continue_series: [], expand_knowledge: [], due_for_review: [] }

      - GET /api/recommendations/gaps
        Get knowledge gap analysis (Pro)
        Response: { gaps: [{ topic, accuracy, suggested_videos: [] }] }

      - POST /api/learning-paths
        Create learning path from goal
        Body: { title, goal_description }
        Response: { id, title, items: [] }

      - GET /api/learning-paths
        List user's learning paths
        Response: { paths: [{ id, title, items_total, items_completed, status }] }

      - GET /api/learning-paths/:id
        Get learning path details
        Response: { id, title, items: [], progress_percentage }

      - PATCH /api/learning-paths/:id
        Update learning path (reorder, add items)
        Body: { items: [] } or { status }

      - DELETE /api/learning-paths/:id
        Delete learning path

      - PATCH /api/learning-paths/:id/items/:itemId
        Update item status (complete, skip)
        Body: { status, session_id }
    </recommendations>

    <preferences>
      - GET /api/users/me/sidebar-preference
        Get sidebar collapse state
        Response: { sidebar_collapsed }

      - PUT /api/users/me/sidebar-preference
        Update sidebar collapse state
        Body: { sidebar_collapsed }
    </preferences>
  </new_api_endpoints>

  <ui_additions>
    <new_components>
      <layout>
        - Sidebar.tsx (main sidebar container)
        - SidebarItem.tsx (individual nav item)
        - SidebarToggle.tsx (collapse/expand button)
        - SidebarLogo.tsx (QuizTube logo, collapsible)
        - SidebarUserAvatar.tsx (avatar with dropdown)
        - SidebarMobileDrawer.tsx (mobile overlay drawer)
        - MainContent.tsx (content area wrapper)
        - AppLayout.tsx (sidebar + main content)
      </layout>

      <search>
        - SearchInput.tsx (input with icon and clear)
        - SearchSuggestions.tsx (autocomplete dropdown)
        - SearchSuggestionItem.tsx (individual suggestion)
        - RecentSearches.tsx (recent searches dropdown)
        - SearchResults.tsx (full results page)
      </search>

      <session>
        - HelpPanel.tsx (slide-out help panel)
        - HelpPanelMobile.tsx (bottom sheet version)
        - SessionNotes.tsx (formatted notes display)
        - NoteSection.tsx (individual note section)
        - TimestampLink.tsx (clickable timestamp)
        - CreatorCard.tsx (creator info and buttons)
        - CreatorEngagementPrompt.tsx (post-session prompt)
        - ContextAwareCodeEditor.tsx (conditional code editor)
      </session>

      <recommendations>
        - RecommendationCard.tsx (individual recommendation)
        - RecommendationsSection.tsx (dashboard section)
        - KnowledgeGaps.tsx (gap analysis display)
        - LearningPathCard.tsx (path summary card)
        - LearningPathDetail.tsx (full path view)
        - LearningPathItem.tsx (individual item in path)
        - CreatePathModal.tsx (create new path)
      </recommendations>

      <common>
        - MaterialIcon.tsx (wrapper for Material Icons)
        - Tooltip.tsx (hover tooltip)
        - DropdownMenu.tsx (user avatar dropdown)
        - BottomSheet.tsx (mobile bottom sheet)
        - URLInput.tsx (YouTube URL with validation)
      </common>
    </new_components>

    <modified_screens>
      <app_layout>
        - Remove top navbar component
        - Add sidebar component
        - Main content shifts right to accommodate sidebar
        - Content width adjusts based on sidebar state
      </app_layout>

      <dashboard>
        - Add recommendations section
        - Add "What to Learn Next" cards
        - Update layout for sidebar width
      </dashboard>

      <session_view>
        - Add "Get Help" button
        - Add help panel (slide-out)
        - Add creator card section
        - Code editor conditionally visible
        - Session notes accessible
      </session_view>

      <session_complete>
        - Add creator engagement prompt
        - Show "Support the Creator" section
      </session_complete>

      <library>
        - Add live search input
        - Real-time filtering as user types
        - Search suggestions dropdown
      </library>

      <new_session>
        - Enhanced URL validation
        - Inline error messages with examples
        - Real-time validation feedback
      </new_session>

      <progress_dashboard>
        - Add knowledge gaps section (Pro)
        - Add learning paths section
      </progress_dashboard>

      <all_pages>
        - Update branding to QuizTube
        - Replace icons with Material Icons
        - Update meta tags and page titles
      </all_pages>
    </modified_screens>

    <new_screens>
      <learning_paths>
        - Learning Paths list view
        - Learning Path detail view
        - Create Learning Path wizard
      </learning_paths>
    </new_screens>
  </ui_additions>

  <dependencies>
    <requires_from_phase2>
      - User authentication system
      - Session management and persistence
      - Stripe subscription (Free/Pro tiers)
      - Progress dashboard
      - Library view with sessions
      - Spaced repetition system
      - Code editor component
      - Framer Motion animations
      - Neobrutalism design system
      - Email templates infrastructure
    </requires_from_phase2>
  </dependencies>

  <implementation_steps>
    <step number="1">
      <title>Foundation - Rebrand and Route Management</title>
      <tasks>
        - Create centralized route configuration file
        - Update all route references to use config
        - Add route guards and helpers
        - Replace all "Teachy" text with "QuizTube"
        - Update page titles and meta tags
        - Update logo assets
        - Update favicon
        - Install Google Material Icons
        - Create MaterialIcon component wrapper
        - Replace existing icons with Material Icons
        - Update email templates with new branding
        - Update Stripe product names
      </tasks>
      <done_when>
        - Zero instances of "Teachy" in UI
        - All routes use centralized config
        - Material Icons rendering correctly
        - Email templates use QuizTube branding
      </done_when>
    </step>

    <step number="2">
      <title>Sidebar Navigation</title>
      <tasks>
        - Create Sidebar component structure
        - Implement dark sidebar styling
        - Add sidebar items with icons
        - Implement collapse/expand animation
        - Add localStorage persistence for collapse state
        - Create user avatar component
        - Add dropdown menu for avatar
        - Hide login/register when authenticated
        - Implement responsive breakpoints
        - Create mobile drawer component
        - Add mobile hamburger menu
        - Test touch interactions on mobile
        - Remove old top navbar
        - Adjust main content layout
      </tasks>
      <done_when>
        - Sidebar renders on all authenticated pages
        - Collapse state persists across refreshes
        - Mobile drawer works with tap/swipe
        - No layout shift when toggling
        - 60fps animations
      </done_when>
    </step>

    <step number="3">
      <title>Learning Notes and Help Panel</title>
      <tasks>
        - Create database tables for notes
        - Implement note generation AI prompt
        - Build notes generation API endpoint
        - Generate notes during session setup
        - Create SessionNotes display component
        - Implement question-to-notes mapping logic
        - Create HelpPanel slide-out component
        - Create HelpPanelMobile bottom sheet
        - Add "Get Help" button to question view
        - Implement timestamp link component
        - Link timestamps to YouTube with ?t= parameter
        - Add code detection logic
        - Implement context-aware code editor toggle
        - Track help panel usage analytics
      </tasks>
      <done_when>
        - Notes generated for every new session
        - Help panel shows relevant notes per question
        - Timestamps open YouTube at correct position
        - Code editor hidden for non-code content
        - Help usage tracked in analytics
      </done_when>
    </step>

    <step number="4">
      <title>Search and URL Validation</title>
      <tasks>
        - Create SearchInput component
        - Implement debounced search API calls
        - Create SearchSuggestions dropdown
        - Add keyboard navigation (up/down/enter)
        - Implement recent searches storage
        - Create recent searches dropdown
        - Add live library filtering
        - Implement search logging for analytics
        - Create URLInput component with validation
        - Implement YouTube URL regex validation
        - Add inline error messages with examples
        - Real-time validation feedback
      </tasks>
      <done_when>
        - Search shows results within 500ms
        - Keyboard navigation works smoothly
        - Recent searches persist and display
        - Library filters in real-time
        - Invalid URLs show helpful errors
      </done_when>
    </step>

    <step number="5">
      <title>Creator Engagement</title>
      <tasks>
        - Create creator_engagements table
        - Implement creator info API endpoint
        - Create CreatorCard component
        - Add Like/Comment/Subscribe buttons
        - Implement engagement tracking API
        - Create post-session engagement prompt
        - Add conditional prompt display logic
        - Track engagement clicks in database
        - Style creator section in neobrutalism
        - Test on mobile devices
      </tasks>
      <done_when>
        - Creator info displays for sessions
        - Buttons open YouTube correctly
        - Engagement clicks tracked
        - Post-session prompt appears appropriately
        - Creator section responsive on mobile
      </done_when>
    </step>

    <step number="6">
      <title>Smart Recommendations</title>
      <tasks>
        - Implement recommendations algorithm
        - Create recommendations API endpoint
        - Build RecommendationsSection component
        - Create RecommendationCard component
        - Add to dashboard layout
        - Implement "Review Needed" logic
        - Implement "Continue Series" logic
        - Implement "Due for Review" integration
        - Create knowledge gaps API (Pro)
        - Build KnowledgeGaps component
        - Create learning paths database tables
        - Implement learning paths CRUD API
        - Build learning path UI components
        - Add Pro tier enforcement
      </tasks>
      <done_when>
        - Dashboard shows personalized recommendations
        - Recommendations update after sessions
        - One-click to start recommended content
        - Knowledge gaps display for Pro users
        - Learning paths creatable and trackable
      </done_when>
    </step>

    <step number="7">
      <title>Polish and QA</title>
      <tasks>
        - Comprehensive cross-browser testing
        - Mobile responsiveness testing (375px, 768px, 1024px)
        - Animation performance optimization (60fps)
        - Accessibility audit (keyboard nav, ARIA labels)
        - Color contrast verification (WCAG AA)
        - Error handling review
        - Loading state completeness
        - Empty state design
        - Edge case handling
        - Performance profiling
        - Search response time optimization
        - Note generation time optimization
        - Documentation updates
      </tasks>
      <done_when>
        - All features work across browsers
        - Mobile experience polished
        - Animations hit 60fps
        - Accessibility standards met
        - No critical bugs
        - Performance targets met
      </done_when>
    </step>
  </implementation_steps>

  <success_criteria>
    <phase_complete_when>
      - All "Teachy" references replaced with "QuizTube"
      - Sidebar navigation working with collapse/expand
      - Session notes generated and accessible for every question
      - Help panel shows relevant notes and timestamps
      - Creator engagement features functional
      - Live search with autocomplete working
      - YouTube URL validation with helpful errors
      - Recommendations showing on dashboard
      - Material Icons throughout UI
      - Mobile experience polished
      - All P0 and P1 features complete
      - Performance targets met (page load less than 2s, search less than 500ms)
      - Animation frame rate 60fps
      - No critical bugs
    </phase_complete_when>
  </success_criteria>

  <out_of_scope>
    - Mobile native apps (iOS/Android)
    - Browser extensions
    - Non-YouTube content (podcasts, articles, PDFs)
    - Study groups / collaborative features
    - Team/Enterprise/School accounts
    - Multi-language support (i18n)
  </out_of_scope>
</phase_specification>
